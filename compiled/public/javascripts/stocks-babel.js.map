{
  "version": 3,
  "sources": [
    "stocks-babel.js"
  ],
  "names": [
    "socket",
    "io",
    "ALPHA_VANTAGE_KEY",
    "DisplayStocks",
    "props",
    "state",
    "stocks",
    "symbols",
    "stockTableColumns",
    "input",
    "bind",
    "clickSearch",
    "requestDelete",
    "on",
    "msg",
    "emit",
    "addOrReplaceStock",
    "stock",
    "symbol",
    "deleteStock",
    "stockPosition",
    "getStocks",
    "ajaxFunctions",
    "ready",
    "ajaxRequest",
    "appUrl",
    "data",
    "parsedData",
    "JSON",
    "parse",
    "length",
    "map",
    "push",
    "chart",
    "setState",
    "message",
    "$",
    "textContent",
    "css",
    "fadeOut",
    "value",
    "toUpperCase",
    "displayMessage",
    "url",
    "ajax",
    "type",
    "dataType",
    "stockdata",
    "stringify",
    "success",
    "info",
    "stk",
    "sym",
    "setStock",
    "includes",
    "indexOf",
    "splice",
    "e",
    "which",
    "requestStock",
    "target",
    "id",
    "split",
    "ajaxDeleteRequest",
    "visibility",
    "React",
    "Component",
    "StockRows",
    "totalStocks",
    "stockRow",
    "i",
    "stockRows",
    "row",
    "Stocks",
    "rowNumber",
    "ReactDOM",
    "render",
    "document",
    "getElementById"
  ],
  "mappings": "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",
  "file": "stocks-babel.js",
  "sourceRoot": "../../../src/public/javascripts",
  "sourcesContent": [
    "var socket = io()\nvar ALPHA_VANTAGE_KEY\n\nclass DisplayStocks extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      stocks: [],\r\n      symbols: [],\r\n      stockTableColumns: 4\r\n    }\r\n    this.input = this.input.bind(this)\r\n    this.clickSearch = this.clickSearch.bind(this)\r\n    this.requestDelete = this.requestDelete.bind(this)\r\n  }\r\n  componentWillMount() {\r\n    socket.on('key', (msg) => {\r\n      ALPHA_VANTAGE_KEY = msg\r\n    })\r\n    socket.emit('keyRequest')\r\n    socket.on('add', (msg) => {\r\n      this.addOrReplaceStock(msg.stock, msg.symbol)\r\n    })\r\n    socket.on('delete', (msg) => {\r\n      this.deleteStock(msg.stockPosition)\r\n    })\r\n    this.getStocks()\r\n  }\r\n  getStocks() {\r\n    ajaxFunctions.ready(ajaxFunctions.ajaxRequest('GET', appUrl + '/api/stocks', (data) => {\r\n      var parsedData = JSON.parse(data)\r\n      if (parsedData.length > 0) {\r\n        var stocks = []\r\n        var symbols = []\r\n        parsedData.map(function(stock) {\r\n          stocks.push(JSON.parse(stock.data))\r\n          symbols.push(stock.symbol)\r\n        })\r\n        chart(stocks)\r\n        this.setState({\r\n          stocks: stocks,\r\n          symbols: symbols\r\n        })\r\n      }\r\n    }))\r\n  }\r\n  displayMessage(message) {\r\n    $('#message')[0].textContent = message\r\n    $('#message').css('visibility', 'visible')\r\n    $('#message').fadeOut(3000, function() {//function actions performed AFTER fadeOut\r\n      $('#message').css('display', '')\r\n      $('#message').css('visibility', 'hidden')\r\n    })\r\n  }\r\n  requestStock() {\r\n    var symbol = $('#stockSearchBox')[0].value.toUpperCase()\r\n    $('#stockSearchBox')[0].value = ''\r\n    var symbols = this.state.symbols\r\n    if (!symbol) {\r\n      this.displayMessage('Stock field empty!')\r\n    } else {\r\n      var url = 'https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=' + symbol + '&apikey=' + ALPHA_VANTAGE_KEY\r\n      ajaxFunctions.ready(ajaxFunctions.ajaxRequest('GET', url, (data) => {\r\n        var parsedData = JSON.parse(data)\r\n        if (parsedData['Error Message']) {\r\n          this.displayMessage('Stock symbol invalid!')\r\n        } else {\r\n          // ajaxFunctions.ready(ajaxFunctions.ajaxSaveRequest('POST', appUrl + '/api/stocks', JSON.stringify(parsedData), (info) => {//method doesn't work on Heroku (data too large for request header)\r\n          //   var parsedInfo = JSON.parse(info)\r\n          //   var stk\r\n          //   var sym\r\n          //   if (parsedInfo.value) {\r\n          //     stk = JSON.parse(parsedInfo.value.data)\r\n          //     sym = parsedInfo.value.symbol\r\n          //   } else {\r\n          //     stk = JSON.parse(parsedInfo.data)\r\n          //     sym = parsedInfo.symbol\r\n          //   }\r\n          //   socket.emit('add', {stock: stk, symbol: sym})\r\n          //   setStock(stk, sym)\r\n          // }))\r\n          $.ajax({\r\n            url: '/api/stocks',\r\n            type: 'POST',\r\n            dataType: 'JSON',\r\n            data: {stockdata: JSON.stringify(parsedData)},\r\n            success: function(info) {\r\n              var stk\r\n              var sym\r\n              if (info.value) {\r\n                stk = JSON.parse(info.value.data)\r\n                sym = info.value.symbol\r\n              } else {\r\n                stk = JSON.parse(info.data)\r\n                sym = info.symbol\r\n              }\r\n              socket.emit('add', {stock: stk, symbol: sym})\r\n              setStock(stk, sym)\r\n            }\r\n          })\r\n        }\r\n      }))\r\n    }\r\n    var setStock = (stk, sym) => {\r\n      this.addOrReplaceStock(stk, sym)\r\n    }\r\n  }\r\n  addOrReplaceStock(stock, symbol) {\r\n    var symbols = this.state.symbols\r\n    var stocks = this.state.stocks\r\n    if (symbols.includes(symbol)) {\r\n      var stockPosition = symbols.indexOf(symbol)\r\n      stocks.splice(stockPosition, 1)\r\n      stocks.splice(stockPosition, 0, stock)\r\n      this.displayMessage(symbol + ' updated!')\r\n    } else {\r\n      stocks.push(stock)\r\n      symbols.push(symbol)\r\n    }\r\n    chart(stocks)\r\n    this.setState({\r\n      stocks: stocks,\r\n      symbols: symbols\r\n    })\r\n  }\r\n  input(e) {\r\n    if (e.which == 13) {\r\n      this.requestStock()\r\n    }\r\n  }\r\n  clickSearch() {\r\n    this.requestStock()\r\n  }\r\n  requestDelete(e) {\r\n    var stockPosition = e.target.id.split('_')[1]\r\n    var symbols = this.state.symbols\r\n    var symbol = symbols[stockPosition]\r\n    ajaxFunctions.ready(ajaxFunctions.ajaxDeleteRequest('DELETE', appUrl + '/api/stocks', symbol, (data) => {\r\n      socket.emit('delete', {stockPosition: stockPosition})\r\n      this.deleteStock(stockPosition)\r\n    }))\r\n  }\r\n  deleteStock(stockPosition) {\r\n    var stocks = this.state.stocks\r\n    stocks.splice(stockPosition, 1)\r\n    chart(stocks)\r\n    var symbols = this.state.symbols\r\n    symbols.splice(stockPosition, 1)\r\n    this.setState({\r\n      stocks: stocks,\r\n      symbols: symbols\r\n    })\r\n  }\r\n  render() {\r\n    return (\r\n      <div id='frame'>\r\n        <div id='page'>\r\n          <h2>Stock Charter</h2>\r\n          <input id='stockSearchBox' type='text' placeholder='Enter stock symbol' onKeyDown={this.input}/>\r\n          <button onClick={this.clickSearch}>Add/update stock</button>\r\n          <div id={`message`} style={{visibility: 'hidden'}}>filler</div>\r\n          <table>\r\n            <StockRows stocks={this.state.stocks} stockTableColumns={this.state.stockTableColumns} requestDelete={this.requestDelete}/>\r\n          </table>\r\n          <div id='chart'></div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nvar StockRows = function(props) {\r\n  var totalStocks = props.stocks.length\r\n  var stocks = []\r\n  var stockRow = []\r\n  for (let i = 0; i < totalStocks; i++) {\r\n    stockRow.push(props.stocks[i])\r\n    if (stockRow.length == props.stockTableColumns || i == totalStocks - 1) {\r\n      stocks.push(stockRow)\r\n      stockRow = []\r\n    }\r\n  }\r\n  var stockRows = stocks.map(function(row, i) {\r\n    return <Stocks key={i} rowNumber={i} row={row} stockTableColumns={props.stockTableColumns} requestDelete={props.requestDelete}/>\r\n  })\r\n  return (\r\n      <tbody>\r\n        {stockRows}\r\n      </tbody>\r\n  )\r\n}\r\n\r\nvar Stocks = function(props) {\r\n  var stocks = props.row.map(function(stock, i) {\r\n    return <td key={props.rowNumber + '_' + i}><div className='cell'>{stock['Meta Data']['2. Symbol']}</div><i id={'delete_' + (props.rowNumber * props.stockTableColumns + i)} className='fa fa-close' onClick={props.requestDelete}></i></td>\r\n  })\r\n  return <tr>{stocks}</tr>\r\n}\r\n\r\nReactDOM.render(<DisplayStocks />, document.getElementById('target'))\r\n"
  ]
}
